### csgo项目

3个设备

1.**红外枪**+身体接收器（接在枪体主板上，并联多个红外接收器）

2.遥控器：设置id和子弹，血量和时间（只是一块核心板+红外发送模块）

3.公示大屏幕（只是一块核心板+2.4g模块）

可拓展方向：使用蓝牙或者WiFi代替NRF24L01，可将信息显示在手机上；同时连接网络可以添加购买子弹，回血包等道具。

#### 枪体

1.OLED显示信息，ID，子弹数，血量，时间，击败数

2.红外发送模块（模拟子弹）：采用规范 NEC红外编码（含id和命令码（子弹））。

3.红外接受模块：并联多个发在衣服上，接收到子弹，血量-10，【也可扩展，头部接收到子弹，血量-50，其他部分血量-10.】

4.NRF24L01（2.4G通信）模块：广播信息，如血量为0，判定死亡，将最后结束到的子弹（红外）中的地址码以及自身的ID通过该模块广播出去，更新战场数据。

5.Led以及串口语音助手，震动马达，在判定死亡后，led闪烁，串口语音助手播报，震动马达震动。

项目难点：

1.红外模块电压小导致传输距离短。【放大电路处理，三极管】

2.红外接收与2.4G通信接收，需要时间分配更加合理，防止相互干扰。

【①利用中断优先级设置，②时刻安排合理eg:在开枪后（发送红外信号）优先接收2.4g信息】

3.**NEC 红外编码**的时间需要精确，使得更规范。【可通过逻辑分析仪处理】



细节描述：
红外通讯:**NEC 红外编码**
①.先发送9ms的前导码
②.3.5ms不信息
③发数据
1. 地址码
2. 地址反码
3. 命令码
4. 命令反码
5. 结束码

逻辑：
//发送红外光， 26.3us这个周期内8.77us发送红外光，17.53us不发送红外光
void Send_IR(unsigned int i)
{
   高电平：8.77us 
   低电平：8.77*2us   
}
void Send_NEC_0//发送逻辑0
{
	Send_IR(20);  //发送载波信号0.56ms, 也就是发送红外光21个周期
	NoSend_IR(20);   //不发送载波信号0.56ms,也是个周期
}

/*
发送二进制数据 1
*/
void Send_NEC_1()
{
	Send_IR(20);    //发送载波信号也是21个周期 21*26.3=
	NoSend_IR(58);     //不发送载波信号为1.68ms 发送周期 = 1680us/26.3us = 63.87
}

延迟函数：采用CPU的内部计数实现精确延时，32位计数器
